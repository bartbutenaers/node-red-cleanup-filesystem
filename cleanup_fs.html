<script type="text/javascript">
    RED.nodes.registerType('cleanup-filesystem', {
        category: 'function',
        color: '#a6bbcf',
        defaults: {
            name: {value: ""},
            baseFolder: {value: ""},
            fileNamePattern: {value: ".*"},
            folderNamePattern: {value: ".*"},
            age: {value: ""},
            ageUnit: {value: "minutes"},
            removeEmptyFolders: {value: false},
            dryRun: {value: true},
            report: {value: false}
        },
        inputs: 1,
        outputs: 1,
        icon: "font-awesome/fa-trash",
        label: function() {
            return this.name || "Cleanup filesystem";
        },
        oneditprepare: function() {
            // Custom logic goes here
        }
    });
</script>

<script type="text/html" data-template-name="cleanup-filesystem">
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-baseFolder"><i class="fa fa-download"></i> Base folder</label>
        <input type="text" id="node-input-baseFolder" placeholder="Base Folder">
    </div>
    <div class="form-row">
        <label for="node-input-fileNamePattern"><i class="fa fa-file"></i> Filename</label>
        <input type="text" id="node-input-fileNamePattern" placeholder="File Name Patterns (semicolon separated)">
    </div>
    <div class="form-row">
        <label for="node-input-folderNamePattern"><i class="fa fa-folder"></i> Foldername</label>
        <input type="text" id="node-input-folderNamePattern" placeholder="Folder Name Patterns (semicolon separated)">
    </div>
    <div class="form-row">
        <label for="node-input-age"><i class="fa fa-clock-o"></i> Age</label>
        <input type="number" id="node-input-age" placeholder="Age" min="1" step="1" style="width:100px; margin-right:5px">
        <select id="node-input-ageUnit" style="width:max-content;">
            <option value="minutes">Minutes</option>
            <option value="hours">Hours</option>
            <option value="days">Days</option>
            <option value="weeks">Weeks</option>
            <option value="months">Months</option>
            <option value="years">Years</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-removeEmptyFolders"><i class="fa fa-trash"></i> Subfolders</label>
        <input type="checkbox" id="node-input-removeEmptyFolders" style="width:auto ;border:none; vertical-align:baseline;">
        <span for="node-input-removeEmptyFolders"> Remove empty subfolders</span>
    </div>
    <div class="form-row">
        <label for="node-input-dryRun"><i class="fa fa-exclamation-triangle"></i> Dry run</label>
        <input type="checkbox" id="node-input-dryRun" style="width:auto ;border:none; vertical-align:baseline;">
        <span for="node-input-dryRun"> Do a test run (without deleting files or folders)</span>
    </div>
    <div class="form-row">
        <label for="node-input-report"><i class="fa fa-list-alt"></i> Report</label>
        <input type="checkbox" id="node-input-report" style="width:auto ;border:none; vertical-align:baseline;">
        <span for="node-input-report"> Report files and folders (in output msg)</span>
    </div>
</script>

<script type="text/html" data-help-name="cleanup-filesystem">
    <p>A Node-RED node that deletes files older than a specified age from a given folder structure.</p>
    <p><strong>Base folder:</strong><br/>The 'baseFolder' parameter represents the root directory where the node starts its operations. It should be a valid path on your system.</p>
    <p><strong>fileNamePatterns:</strong><br/>The 'fileNamePatterns' parameter is an array of strings, each representing a pattern that file names should match. The node will only process files whose names match one of these patterns.</p>
    <p><strong>folderNamePatterns:</strong><br/>The 'folderNamePatterns' parameter is an array of strings, each representing a pattern that folder names should match. The node will only process folders whose names match one of these patterns.</p>
    <p><strong>age:</strong><br/>The 'age' parameter represents the age of files to be processed. It should be a positive integer. Files older than this age will be processed by the node.</p>
    <p><strong>ageUnit:</strong><br/>The 'ageUnit' parameter represents the unit of 'age'. It should be one of the following strings: 'seconds', 'minutes', 'hours', 'days', 'weeks', 'months', or 'years'. The node will calculate the age of files based on this unit.</p>
    <p><strong>Remove empty folders:</strong><br/>The 'removeEmptyFolders' parameter is a boolean that determines whether the node should remove empty folders after processing. If set to tr>
    <p><strong>Do a test run:</strong><br/>The 'dryRun' parameter is a boolean to specify whether the node should do a test run, to report files that would be deleted (without actually deleting them).</p>
    <p><strong>Report files and folders:</strong><br/>The 'report' parameter is a boolean to specify whether the path of the (to be) deleted files and folders will be send in the output 'msg.payload.report'.</p>
    <p>Please ensure to specify all these parameters either in the config screen or in the input message payload.</p>
</script>
